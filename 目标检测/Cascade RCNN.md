---
title: Cascade RCNN
tags: 新建,模板,小书匠
grammar_cjkRuby: true
---

### 目前在目标检测中存在的问题
在目标检测中，IOU是区分正负样本点关键。检测器以0.5为IOU的阈值时，它的检测性能不是特别好。 (FasterRcnn用的就是以0.5为IOU的阈值。)随着IOU阈值的增加，检测的能力在不断的降低。而导致这一问题出现的原因主要可以归结为以下两点：
* 在训练阶段存在过拟合的问题，当IOU的阈值稍微增加一点，正样本的数量就会急剧变化
* 检测器设定进行训练的IOU与我们在输入样本与真值之间的IOU在推理时间上的mismatch.

### 结构特点
* 多阶段的检测器  (每个阶段的IOU阈值不断增加，增加的阈值可以对某些误检的目标有一定的选择性)
* 一个检测器训练的结果作为下一个检测器的输入，同时保证了所有的检测器具有一组相同大小的正样本，从而在一定程度上避免了过拟合
* 推理时采用相同的级联过程，使得在各个阶段输入的IOU与检测器设定的IOU更加接近。


### 网络结构

![Cascade RCNN](./images/1584941636945.png)


### IOU的选择问题
在目标检测当中，我们需要通过IOU来区分正负样本，典型的IOU阈值一般取为0.5,但是通常情况下，**close false positives**的样本是可以通过IOU>=0.5的筛选，而当IOU<0.5的时候，样本虽然比较丰富，但是增加了检测器抑制误检样本的难度。

![IOU阈值与样本数量的关系](./images/1584942586811.png)
从图中，我们可以清楚地看到，当IOU值越小时，我们输入网络的内容会更多，更。丰富；而当IOU阈值比较高时，我们输入网络的内容更接近于真实值，但是数据量会大大减少。

**==根据之前别人的工作，我们可以发现，单个检测器的性能只能在单个IOU阈值上达到最佳 #F44336==**

![localization and detection performance](./images/1584943076556.png)

**图中的三条线表示的是检测器的IOU阈值，分别取0.5、0.6、0.7，横坐标表示输入的候选区域的IOU阈值**

如上图所示，分别表示的是在不同IOU的取值下，回归以及检测精度的一个变化曲线，在左图中我们可以发现，在回归任务中，输入的IOU在经过回归之后总是会得到更大的IOU。
在上图中的左图，我们可以发现大致在输入的**IOU与检测器的IOU相一致的情况下，会得到最佳的表现**
在上图中的右图，我们可以发现在IOU 阈值较低的情况下，检测器的IOU取0.5的表现要由于0.6，但是在阈值过高的情况下，表现性能则恰恰相反。这就表明，**==一个检测器最优的IOU阈值不一定适用于别的检测器 #F44336==**。
通常情况下，要得到最优的检测器，就需要有最优的选择性输入。要得到最优的建议输入，就需要不断地提高输入数据的IOU阈值，可以依上右图可以看到，以0.7为阈值时，它的检测性能是在下降，因为它导致了数据分布的不平衡性。从而引发了两大相互矛盾的问题：
* 过拟合的问题(==提高输入数据的IOU阈值 #03A9F4==)
* 训练的IOU与我们在输入样本与真值之间的IOU在推理时间上的mismatch(==IOU阈值过高 #03A9F4==)

### Cascade RCNN

* 一个多阶段的RCNN,顺序级联
* 训练的时候按顺序依次训练
* 第一个RCNN的输出作为第二个RCNN的输入，依次传递
* 有一个重采样的过程，能更好地发现**close false positives**

