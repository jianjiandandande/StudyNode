# 支持向量机(SVM)

## 解决的问题

它做的是一个分类的操作，找到一条线(w和b),使得离该线最近的点能够最远。

## 模型

`y(x) = wTΦ(x)+b`

`y(xi)>0==>yi=+1`
`y(xi)<0==>yi=-1`

可得 yi·y(xi)>0

## 目标函数

* `argmax{1/||w||min[yi·(wTΦ(x)+b)]}` ||w||表示的是平面法向量的模

* 通过缩放(w,b)的方式,我们可以使`yi·(wTΦ(x)+b)≥1`,从而用1来代替这个式子

* 最终，我们的目标函数就变成了`argmax(1/||w||)`,且`yi·(wTΦ(x)+b)≥1`

* 我们使用w^2来代替法向量的模长，也就是||w||,此时，我们的目标函数就变成了`min(1/2)w^2`,且`yi·(wTΦ(x)+b)≥1`

* 大家可以看到上一步的目的其实就是要找目标函数的条件极值，这里我们引入拉格朗日乘数法对其进行求解

* `L(w,b,α) = 1/2w^2 - ∑αi·g(x)` ==>`L(w,b,α) = f(w,b) + αg(w,b)`

* 因此我们的目标函数可以写为 `min_{w,b} max_{α} L(w,b,α)`。

* **用对偶表达式**： `max_{α} min_{w,b} L(w,b,α) = min_{w,b} max_{α} L(w,b,α)`由于我们的优化是满足强对偶的（强对偶就是说对偶式子的最优值是等于原问题的最优值的）

* 所以我们的目标函数就变成了`max_{α} min_{w,b} L(w,b,α)`

* 得到上一步的结果之后，我们可以通过`L(w,b,α)`分别对w,b求偏导，然后回代到原来的L(w,b,α)当中，此时，我们的式子就变成了一个没有w,b只有α的式子

    * 求偏导之后可以得到`w = ∑αiyiΦ(xi)`和`∑αiyi = 0`

* 目标函数再一次变为：`max{α}_∑αi-(1/2)∑∑αiαjyiyj(Φ(xi)T·Φ(xj))`，条件为`∑αiyi=0,αi≥0`

* 再进行变换，目标函数变为：`min{α}(1/2)∑∑αiαjyiyj(Φ(xi)T·Φ(xj)) - ∑αi`,条件为`∑αiyi=0,αi≥0`

* 找到训练的点，将具体的值代入当目标函数当中，然后使其偏导为0，得到`max_{α}`

* 然后将`max_{α}`带入到上边对w,b的偏导当中，w和b就都可以算出来了，而此时`f(w,b)`也就确定了

## 结论

通过上边的求解过程，我们会发现一个问题，在平面的计算过程中，我们只用到了距离平面最近的两个点，这两个点就叫做支持向量。


## 软间隔问题

提高支持向量机的容忍效果(允许一些点有一些小问题)

### 松弛因子

* 条件变为 `yi·(wTΦ(x)+b)≥1-ζ`

* 目标函数 `min(1/2)w^2 + C∑ζ`

  * 当C趋近于无穷大时，意味着分类严格不能有错误

  * 当C趋近于很小时，意味着可以有更大的错误容忍

* 此时再使用拉格朗日乘数法进行求解(在原来的基础上，引入了两个未知数 ，ζ和μ)

   **约束条件：**

   * `w = ∑αiyiΦ(xi)`

   * `∑αiyi = 0`

   * C-α-μ = 0

## 高斯核函数：

`K(X,Y) = exp{-(||X-Y||^2)/2*σ^2}`

核函数可以对原始空间做一个变换，使得低维不可分转换为高维可分。
